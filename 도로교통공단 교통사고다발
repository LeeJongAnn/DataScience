import pandas as pd 
from plotnine import*
import matplotlib.pyplot as plt
%matplotlib inline
import seaborn as sns
import warnings
warnings.filterwarnings('ignore')
from matplotlib import font_manager,rc
font_n = font_manager.FontProperties(fname='c:/Windows/Fonts/malgun.ttf').get_name()
rc('font',family=font_n)
plt.style.use('ggplot')
import folium

sad = pd.read_csv("C:/Users/Lee Jong Ann/Downloads/도로교통공단_교통사고다발지역_20191010.csv",encoding='cp949')
sad.columns
sad.tail()
sad['시도시군구명'].unique()
fig,ax= plt.subplots()
fig.set_size_inches(18,8)

sns.countplot(data=sad,x='사고년도',hue='사고유형구분',ax=ax)
plt.ylabel("발생한 사고의 건수")
print("전체적인 사고의 양은 12년도부터 18년도까지 감소하고 있음을 알 수 있다.")
print("가장 많이 감소한 것은 무단횡단 관련사고로 12년도부터 18년도까지 꾸준히 감소했다")
print("두번째로 많이 감소한 것은 자전거 관련사고로 15년도까지는 증가하는 추세를 보이다가 계속 감소했다.")
print("보행노인에 대한 교통사고 건수는 좀처럼 줄어들고 있지 않다. 그러므로 우리 사회는 나이드신 분들이 사고를 겪지 않도록 대책을 마련할 필요가 있어보인다.")
(ggplot(sad)
 + aes(x='사고년도', y='발생건수',fill='사망자수')
 + geom_bar(stat='identity', position='dodge')
 + facet_wrap('사고유형구분')
 + theme(text=element_text(family=font_n),
         axis_text_x=element_text(rotation=70),
         figure_size=(12, 12))
)
